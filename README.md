# UTAMEMO - 学習支援AIアプリケーション

## アプリ名
UTAMEMO（ウタメモ）  
ノートや教科書の内容を「歌」で覚える学習支援 Web アプリケーション

## 概要
教科書やノートの画像をアップロードすると、AI が内容を読み取り、覚えやすい歌詞を自動生成します。  
さらに、AI がその歌詞から楽曲を生成することで、音楽を聞きながら楽しく暗記・復習ができるアプリです。

## 主な機能
- 画像からのテキスト抽出（OCR）
- 学習内容を歌詞に変換（暗記に最適化した歌詞生成）
- 漢字・数字の自動ひらがな変換
- AI による楽曲生成（ジャンル・ボーカルスタイル選択可能）
- リファレンス楽曲によるスタイル指定
- 手動での歌詞入力モード
- ユーザー登録・ログイン機能
- マイページでの楽曲管理（削除機能付き）
- プロフィール画像設定（Base64でDB保存、サーバー再起動後も維持）
- ユーザーデータの暗号化（プライバシー保護）
- 楽曲の公開 / 非公開設定
- 多言語対応（日本語 / English / 中文）
- レスポンシブデザイン（PC / スマートフォン対応）
- 総再生回数の表示（全ユーザーの再生数をカウント）
- 総いいね数の表示（各楽曲のいいね数をリアルタイム更新）
- お気に入り・いいね機能（ソングリストからも操作可能）
- クリエイターアバター表示（ソングリストでアーティストプロフィールへリンク）
- アップロード画像の自動削除（楽曲生成完了後にサーバー容量を節約）

### 必須要件
- Python 3.11.x
- Django 5.x
- macOS / Windows 10 / 11

※ 本番環境では Render（Python 3.11.0 / PostgreSQL）での動作を前提としています。

## デプロイメント関連ドキュメント

- **[ドメイン設定とDNSレコードの確認（日本語）](DOMAIN_SETUP.md)** - カスタムドメインとDNS設定の詳細ガイド
- **[Domain Setup and DNS Records (English)](DOMAIN_SETUP_EN.md)** - Comprehensive guide for custom domain and DNS configuration

### 主要パッケージ
- google-generativeai
- cryptography（暗号化）
- Pillow（画像処理）
- requests（HTTP 通信）

### 使用 API
- Google Gemini API（gemini-2.5-flash）
  - OCR（画像からテキスト抽出）
  - 歌詞生成
  - ひらがな変換
- Mureka AI API（楽曲生成）

## 動作確認環境

### 推奨ブラウザ
- Google Chrome (最新版)
- Microsoft Edge (最新版)
- Firefox (最新版)

### 動作確認済み環境
- Windows 11
- Python 3.14.0
- Django 5.2.7

## その他事項

### プロジェクト構成
```
UTAMEMO/
├── myproject/
│   ├── myproject/          # Django設定
│   │   ├── settings.py     # 各種設定
│   │   ├── urls.py         # URLルーティング
│   │   └── wsgi.py
│   ├── songs/              # 楽曲管理アプリ
│   │   ├── models.py       # データモデル
│   │   ├── views.py        # ビュー
│   │   ├── ai_services.py  # AI統合
│   │   ├── encryption.py   # 暗号化機能
│   │   └── urls.py
│   ├── users/              # ユーザー管理アプリ
│   │   ├── models.py
│   │   ├── views.py
│   │   └── urls.py
│   ├── templates/          # HTMLテンプレート
│   ├── static/             # 静的ファイル
│   ├── media/              # アップロード画像
│   ├── .env                # 環境変数
│   └── manage.py
├── requirements.txt        # 依存パッケージ
└── README.txt             # このファイル
```

### セキュリティ機能
- ユーザーデータの暗号化（Fernet対称鍵暗号）
- 非公開楽曲はサーバー管理者も閲覧不可
- 公開時のみ復号化して平文保存
- プロフィール画像はBase64エンコードでDBに直接保存（外部ファイル参照なし）
- アップロード画像は楽曲生成完了後に自動削除（個人情報保護）

---

## プライバシー・倫理・安全性への配慮

### ① 個人情報やプライバシーへの配慮

本アプリケーションでは、以下の方法でユーザーの個人情報とプライバシーを保護しています：

- **最小限のデータ収集**: ユーザー名、メールアドレス、パスワードのみを必須情報として収集
- **非公開楽曲の暗号化**: Fernet対称鍵暗号を使用し、非公開設定の楽曲データ（歌詞・タイトル等）を暗号化保存
- **サーバー管理者も閲覧不可**: 暗号化されたデータは復号鍵なしでは読み取り不可能
- **アップロード画像の自動削除**: 教科書・ノート画像は楽曲生成完了後に自動的にサーバーから削除され、個人の学習内容が長期保存されない
- **プロフィール画像のDB保存**: 外部ファイル参照ではなくBase64でDBに直接保存し、ファイルアクセスリスクを排除
- **ユーザー主導の削除**: ユーザーは自分の楽曲・アカウントをいつでも削除可能
- **公開/非公開の選択権**: 楽曲ごとに公開・非公開を設定でき、プライバシーをユーザー自身がコントロール

### ② 著作権・ライセンスの扱い

本アプリケーションは著作権に十分配慮した設計となっています：

- **オリジナルコンテンツの生成**: AIが生成する歌詞・楽曲は、既存の楽曲をコピーするのではなく、ユーザーの学習内容に基づいてオリジナルで生成
- **学習目的の利用**: 教科書・ノートの内容を「暗記用の歌」に変換する教育目的での利用を想定
- **API利用規約の遵守**: Google Gemini API、Mureka AI APIの利用規約に従って使用
- **商用利用時の注意**: 商用利用の際は各APIの利用規約を確認するよう注意事項に明記
- **ユーザーへの責任明示**: アップロードするコンテンツの著作権についてはユーザー自身の責任であることを前提

### ③ データの扱い

データの安全性を確保するために以下の対策を実施しています：

- **暗号化技術**: 
  - Fernet対称鍵暗号（AES-128-CBC + HMAC-SHA256）を使用
  - 非公開楽曲のタイトル・歌詞・原文を暗号化保存
- **安全な通信**: HTTPS通信による暗号化（Render本番環境）
- **環境変数での秘密情報管理**: APIキー、SECRET_KEYは`.env`ファイルで管理し、Gitリポジトリには含めない
- **データベースセキュリティ**: PostgreSQL（本番環境）でのセキュアなデータ保存
- **一時ファイルの適切な処理**: アップロード画像は処理完了後に自動削除
- **セッション管理**: Django標準のセッション管理機能を使用

### ④ AI・センサー等を使う場合の倫理配慮

AI技術の利用において、以下の倫理的配慮を行っています：

- **透明性**: 
  - AIによる歌詞生成・楽曲生成であることをユーザーに明示
  - 使用しているAIサービス（Gemini、Mureka）を明記
- **ユーザーの編集権**: AI生成後もユーザーが歌詞を自由に編集可能
- **目的の明確化**: 教育・学習支援という明確な目的でのAI利用
- **過度なデータ収集の回避**: AI処理に必要な最小限のデータのみを送信
- **バイアスへの配慮**: 学習コンテンツをそのまま歌詞化するため、AI独自の偏見が入りにくい設計
- **人間の判断の尊重**: 最終的な公開・利用判断はユーザーが行う

### ⑤ 利用者や社会にとって安心できる工夫

ユーザーと社会の安心のために以下の工夫を実施しています：

- **教育目的の明確化**: 「勉強を楽しくする」という前向きな目的を明示
- **多言語対応**: 日本語・英語・中国語に対応し、多様なユーザーが利用可能
- **直感的なUI**: 複雑な操作なしで利用でき、デジタルリテラシーに関わらず使用可能
- **レスポンシブデザイン**: PC・スマートフォン両方で快適に利用可能
- **エラーハンドリング**: 処理中のエラーを適切に通知し、ユーザーを混乱させない
- **再試行機能**: 楽曲生成に失敗した場合の自動再試行（最大3回）
- **コミュニティ機能の適切な制限**: 
  - 公開楽曲のみ他ユーザーが閲覧可能
  - 不適切なコンテンツはユーザー自身の判断で非公開設定可能

---

### 開発者
Yu

### バージョン
1.2.0 (2026年1月14日)

### 更新履歴
- v1.2.0 (2026/1/14)
  - プロフィール画像のBase64保存（Render再起動後も維持）
  - 総再生回数表示（全ユーザーの再生数をカウント）
  - アップロード画像の自動削除（楽曲生成完了後）
  - クリエイターアバター表示（ソングリスト）
  - アーティストプロフィールへのリンク機能
  - ソングリストからのいいね・お気に入り機能
  - モバイルUI/UXの改善
- v1.1.0 (2026/1/14)
  - 多言語対応（日本語 / English / 中文）
  - モバイルUI改善
  - プロフィール画像機能
  - 楽曲削除機能
  - リファレンス楽曲機能
  - UI/UX全体的な改善

1. アカウント登録
2. 教材の写真をアップロード
3. 楽曲が自動生成されます
4. マイページで楽曲を聴いたり管理できます
```
